profvis::profvis({sitesToExclude <- NULL
final = NULL
start.time = Sys.time()})
library(rtracklayer)
library(GenomicRanges)
library(fcScan,lib.loc="~/project/R_devel/")
browseVignettes(fcScan)
browseVignettes("fcScan")
x1 = data.frame(seqnames = rep("chr1", times = 17),
start = c(1,10,17,25,27,32,41,47,60,70,87,94,99,107,113,121,132),
end = c(8,15,20,30,35,40,48,55,68,75,93,100,105,113,120,130,135),
strand = c("+","+","+","+","+","+","+","+","+",
"+","+","+","+","+","+","+","-"),
site = c("s3","s1","s2","s2","s1","s2","s1","s1","s2","s1","s2",
"s2","s1","s2","s1","s1","s2"))
x1
getCluster(x1, w = 20, c = c("s1" = 1, "s2" = 1), greedy=TRUE, verbose=TRUE)
getCluster(x1, w = 27, c = c("s1" = 2, "s2" = 2), greedy=TRUE, verbose=TRUE)
getCluster(x1, w = 20, c = c("s1" = 1, "s2" = 1), greedy=TRUE, verbose=TRUE)
sessionInfo()
getCluster(x1, w = 20, c = c("s1" = 1, "s2" = 1), greedy=TRUE, verbose=TRUE)
getCluster(x1, w = 20, c = c("s1" = 1, "s2" = 1), greedy=TRUE, verbose=FALSE)
getCluster(x1, w = 20, c = c("s1" = 1, "s2" = 1), greedy=TRUE, verbose=TRUE)
?getClass
?getCluster
browseVignettes("fcScan")
x1 = data.frame(seqnames = rep("chr1", times = 17),
start = c(1,10,17,25,27,32,41,47,60,70,87,94,99,107,113,121,132),
end = c(8,15,20,30,35,40,48,55,68,75,93,100,105,113,120,130,135),
strand = c("+","+","+","+","+","+","+","+","+",
"+","+","+","+","+","+","+","-"),
site = c("s3","s1","s2","s2","s1","s2","s1","s1","s2","s1","s2",
"s2","s1","s2","s1","s1","s2"))
getCluster(x1, w = 20, c = c("s1" = 1, "s2" = 1), greedy=TRUE, verbose=FALSE)
getCluster(x1, w = 21, c = c("s1" = 1, "s2" = 1), greedy=TRUE, verbose=FALSE)
View(x1)
getCluster(x1, w = 21, c = c("s1" = 1, "s2" = 1), intra_distance = -3, greedy=TRUE, verbose=FALSE)
